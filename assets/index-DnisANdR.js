import{r as u,a as ze,A as L,U as I,L as z,H as R,W as E,S as v,M,P as oe,Z as w,T as _e,B as Ee,b as y,C as V,c as ne,d as Z,e as X,f as T,g as ie,O as D,F as ce,h as de,i as xe,D as me,j as ue,k as J,l as Ce,G as be,m as Pe,n as pe,o as Ae,p as Le,q as Re,s as Me,t as Y,u as Te,v as Oe,w as $e,R as Ue}from"./vendor-CbY98W4W.js";import{C as U,A as K,W as Q,a as Ie,P as De,b as He,p as Be,l as se,s as We}from"./engine-DEAhEcxm.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function l(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=l(r);fetch(r.href,n)}})();var he={exports:{}},H={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fe=u,Ge=Symbol.for("react.element"),Ve=Symbol.for("react.fragment"),Ke=Object.prototype.hasOwnProperty,Ye=Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qe={key:!0,ref:!0,__self:!0,__source:!0};function fe(t,s,l){var a,r={},n=null,c=null;l!==void 0&&(n=""+l),s.key!==void 0&&(n=""+s.key),s.ref!==void 0&&(c=s.ref);for(a in s)Ke.call(s,a)&&!Qe.hasOwnProperty(a)&&(r[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)r[a]===void 0&&(r[a]=s[a]);return{$$typeof:Ge,type:t,key:n,ref:c,props:r,_owner:Ye.current}}H.Fragment=Ve;H.jsx=fe;H.jsxs=fe;he.exports=H;var e=he.exports,q={},ae=ze;q.createRoot=ae.createRoot,q.hydrateRoot=ae.hydrateRoot;const qe="modulepreload",Ze=function(t,s){return new URL(t,s).href},re={},Xe=function(s,l,a){let r=Promise.resolve();if(l&&l.length>0){const c=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.allSettled(l.map(d=>{if(d=Ze(d,a),d in re)return;re[d]=!0;const x=d.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(!!a)for(let m=c.length-1;m>=0;m--){const g=c[m];if(g.href===d&&(!x||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${b}`))return;const p=document.createElement("link");if(p.rel=x?"stylesheet":qe,x||(p.as="script"),p.crossOrigin="",p.href=d,o&&p.setAttribute("nonce",o),document.head.appendChild(p),x)return new Promise((m,g)=>{p.addEventListener("load",m),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function n(c){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=c,window.dispatchEvent(i),!i.defaultPrevented)throw c}return r.then(c=>{for(const i of c||[])i.status==="rejected"&&n(i.reason);return s().catch(n)})},Je=({onStart:t,onAchievements:s,onLibrary:l,onPowerUp:a,stats:r})=>{const[n,c]=u.useState("MAIN");return n==="CHAR_SELECT"?e.jsx("div",{className:"absolute inset-0 flex flex-col items-center bg-slate-950 z-50 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-6xl w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-slate-800 pb-4 sticky top-0 bg-slate-950/95 backdrop-blur z-20 py-4",children:[e.jsxs("button",{onClick:()=>c("MAIN"),className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(L,{size:20})," Back"]}),e.jsx("h2",{className:"text-4xl text-red-500 fantasy-font drop-shadow-lg",children:"Select Survivor"}),e.jsx("div",{className:"w-16"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-8",children:U.map(i=>{const o=i.isUnlocked(r);return e.jsx("button",{onClick:()=>o&&t(i.id),disabled:!o,className:`relative group text-left rounded-xl overflow-hidden border-2 transition-all duration-300 ${o?"bg-slate-900 border-slate-700 hover:border-slate-500 hover:bg-slate-800 hover:-translate-y-1 hover:shadow-xl":"bg-slate-950 border-slate-900 opacity-60 cursor-not-allowed grayscale"}`,style:{borderColor:o?i.color:void 0},children:e.jsxs("div",{className:"relative p-5 z-10 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-2xl font-bold fantasy-font leading-none mb-1 ${o?"text-slate-100":"text-slate-500"}`,children:i.name}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-500",children:i.title})]}),e.jsx("div",{className:"w-12 h-12 rounded-lg border-2 flex items-center justify-center bg-slate-950",style:{borderColor:o?i.color:"#334155"},children:o?e.jsx(I,{style:{color:i.color}}):e.jsx(z,{className:"text-slate-600"})})]}),e.jsx("div",{className:"flex-1 mb-6",children:o?e.jsxs("p",{className:"text-slate-400 text-sm italic leading-relaxed",children:['"',i.description,'"']}):e.jsxs("div",{className:"bg-red-950/30 border border-red-900/50 p-3 rounded flex items-start gap-3 mt-2",children:[e.jsx(z,{size:16,className:"text-red-500 shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-red-500 text-xs font-bold uppercase",children:"Locked"}),e.jsx("p",{className:"text-red-300 text-xs font-medium opacity-70",children:i.unlockCondition})]})]})}),e.jsxs("div",{className:"bg-black/40 rounded p-3 grid grid-cols-2 gap-2 text-xs border border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[e.jsx(R,{size:14,className:o?"text-red-500":"text-slate-600"}),e.jsxs("span",{className:"font-mono",children:[i.baseStats.maxHp," HP"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[e.jsx(E,{size:14,className:o?"text-blue-400":"text-slate-600"}),e.jsxs("span",{className:"font-mono",children:[i.baseStats.speed," Spd"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[e.jsx(v,{size:14,className:o?"text-orange-500":"text-slate-600"}),e.jsxs("span",{className:"font-mono",children:[Math.round(i.baseStats.might*100),"% Dmg"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-300",children:[e.jsx(M,{size:14,className:o?"text-cyan-500":"text-slate-600"}),e.jsxs("span",{className:"font-mono",children:[Math.round(i.baseStats.area*100),"% Area"]})]})]})]})},i.id)})})]})}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-slate-900 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-red-900/20 via-slate-900 to-black pointer-events-none"}),e.jsx("h1",{className:"text-6xl md:text-8xl text-red-600 fantasy-font mb-2 text-center animate-pulse drop-shadow-[0_0_15px_rgba(220,38,38,0.5)]",children:"CRIMSON SURVIVOR"}),e.jsx("p",{className:"text-slate-500 font-mono mb-12 text-sm tracking-[0.5em] uppercase",children:"The Night is Endless"}),e.jsxs("div",{className:"flex flex-col gap-4 w-full max-w-xs z-10",children:[e.jsxs("button",{onClick:()=>c("CHAR_SELECT"),className:"group flex items-center justify-center gap-3 px-8 py-4 bg-red-800 hover:bg-red-700 text-white rounded border border-red-600 transition-all hover:scale-105 shadow-lg shadow-red-900/20",children:[e.jsx(oe,{size:24,className:"group-hover:fill-current"}),e.jsx("span",{className:"font-bold text-xl tracking-wider",children:"START GAME"})]}),e.jsxs("button",{onClick:a,className:"flex items-center justify-center gap-2 px-4 py-3 bg-yellow-900/20 hover:bg-yellow-900/40 text-yellow-500 rounded border border-yellow-700/50 transition-all hover:text-yellow-400",children:[e.jsx(w,{size:20}),e.jsx("span",{className:"font-bold text-lg tracking-wider",children:"POWER UP"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:s,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded border border-slate-600 transition-all hover:text-white",children:[e.jsx(_e,{size:18}),e.jsx("span",{className:"font-bold text-sm tracking-wider",children:"RECORDS"})]}),e.jsxs("button",{onClick:l,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-slate-800 hover:bg-slate-700 text-slate-300 rounded border border-slate-600 transition-all hover:text-white",children:[e.jsx(Ee,{size:18}),e.jsx("span",{className:"font-bold text-sm tracking-wider",children:"LIBRARY"})]})]})]}),e.jsxs("div",{className:"mt-16 text-slate-500 text-sm flex gap-8 font-mono",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(y,{size:16,className:"mb-1"}),e.jsxs("span",{children:[r.totalKills.toLocaleString()," KILLS"]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(I,{size:16,className:"mb-1"}),e.jsxs("span",{children:[U.filter(i=>i.isUnlocked(r)).length," / ",U.length," CHARS"]})]})]})]})},le=(t,s=!1)=>{if(s)switch(t){case"spinach":return e.jsx(y,{size:18,className:"text-red-400"});case"empty_tome":return e.jsx(T,{size:18,className:"text-yellow-400"});case"candelabrador":return e.jsx(M,{size:18,className:"text-cyan-400"});case"bracer":return e.jsx(E,{size:18,className:"text-slate-300"});case"clover":return e.jsx(X,{size:18,className:"text-green-400"});case"wings":return e.jsx(E,{size:18,className:"text-slate-200"});case"attractorb":return e.jsx(Z,{size:18,className:"text-blue-400"});case"pummarola":return e.jsx(R,{size:18,className:"text-pink-400"});case"duplicator":return e.jsx(ne,{size:18,className:"text-indigo-400"});default:return e.jsx(V,{size:18,className:"text-white"})}switch(t){case"shadow_bolt":return e.jsx(w,{size:18,className:"text-indigo-400"});case"umbral_barrage":return e.jsx(w,{size:18,className:"text-purple-400 drop-shadow-[0_0_5px_rgba(168,85,247,0.8)]"});case"obsidian_shard":return e.jsx(y,{size:18,className:"text-slate-400"});case"spectral_shield":return e.jsx(ue,{size:18,className:"text-cyan-400"});case"corrosive_aura":return e.jsx(V,{size:18,className:"text-lime-400"});case"thunder_strike":return e.jsx(w,{size:18,className:"text-fuchsia-400"});case"plasma_cutter":return e.jsx(D,{size:18,className:"text-orange-400"});case"blood_siphon":return e.jsx(me,{size:18,className:"text-red-500"});case"frost_nova":return e.jsx(xe,{size:18,className:"text-cyan-300"});case"whirling_axe":return e.jsx(de,{size:18,className:"text-yellow-600"});case"flame_breath":return e.jsx(ce,{size:18,className:"text-orange-500"});case"void_trap":return e.jsx(V,{size:18,className:"text-purple-800"});case"ricochet_blade":return e.jsx(v,{size:18,className:"text-slate-300"});case"vortex_orb":return e.jsx(D,{size:18,className:"text-violet-600"});case"inferno_grenade":return e.jsx(ie,{size:18,className:"text-red-600"});case"phantom_daggers":return e.jsx(v,{size:18,className:"text-slate-200"});default:return e.jsx(v,{size:18,className:"text-white"})}},et=({player:t,score:s,time:l,flavorText:a})=>{if(!t)return null;const r=Math.floor(l/60),n=l%60,c=`${r.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`,i=t.xp/t.nextLevelXp*100,o=t.hp/t.maxHp*100,d=6,x=t.weapons.slice(0,d),b=Array(Math.max(0,d-x.length)).fill(null),f=t.passives.slice(0,d),p=Array(Math.max(0,d-f.length)).fill(null);return e.jsxs("div",{className:"absolute inset-0 pointer-events-none p-4 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start w-full",children:[e.jsxs("div",{className:"bg-black/60 backdrop-blur-md p-3 rounded-lg border border-white/10 flex items-center gap-3 pr-6 shadow-lg",children:[e.jsx("div",{className:"w-10 h-10 rounded border-2 border-slate-700 bg-slate-900 flex items-center justify-center text-xl font-bold font-mono",style:{color:t.color,borderColor:`${t.color}60`},children:t.level}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-400 uppercase font-bold tracking-wider text-[10px]",children:"Level"}),e.jsx("div",{className:"h-2 bg-slate-800 rounded-full overflow-hidden mt-1 w-32 border border-slate-700",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${i}%`}})})]})]}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"bg-black/60 backdrop-blur-md px-8 py-2 rounded-b-xl border-x border-b border-white/10 shadow-lg",children:[e.jsx("h1",{className:"text-4xl font-bold fantasy-font text-slate-100 tracking-widest drop-shadow-md",children:c}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-red-500 font-mono font-bold mt-1 text-sm",children:[e.jsx(y,{size:14}),e.jsx("span",{children:s.toLocaleString()})]})]})}),e.jsxs("div",{className:"flex flex-col items-end gap-1 pointer-events-auto",children:[e.jsxs("div",{className:"flex gap-1 mb-1",children:[x.map((m,g)=>e.jsxs("div",{className:"group relative w-10 h-10 bg-slate-900/90 border border-slate-600 rounded shadow-lg flex items-center justify-center overflow-hidden",children:[e.jsx("div",{className:"absolute top-[-4px] right-[-4px] border border-slate-600 text-white w-4 h-4 flex items-center justify-center rounded-full font-bold z-10 text-[9px] bg-black",children:m.level}),e.jsx("div",{className:"opacity-90",children:le(m.id,!1)}),m.cooldownTimer>0&&e.jsx("div",{className:"absolute inset-0 bg-black/60",style:{height:`${m.cooldownTimer/m.cooldown*100}%`,transformOrigin:"bottom",transition:"height 0.1s linear"}}),e.jsxs("div",{className:"absolute bg-slate-900 border border-slate-600 rounded p-2 shadow-xl hidden group-hover:block z-50 text-left w-48 right-full mr-2 top-0",children:[e.jsx("h4",{className:"text-sm font-bold text-yellow-400",children:m.name}),e.jsx("p",{className:"text-xs text-slate-300",children:m.description})]})]},`w-${g}`)),b.map((m,g)=>e.jsx("div",{className:"w-10 h-10 bg-black/40 border border-slate-800 rounded flex items-center justify-center",children:e.jsx("div",{className:"w-1 h-1 rounded-full bg-slate-800 opacity-50"})},`we-${g}`))]}),e.jsxs("div",{className:"flex gap-1",children:[f.map((m,g)=>e.jsxs("div",{className:"group relative w-8 h-8 bg-slate-900/90 border border-slate-700 rounded shadow-lg flex items-center justify-center",children:[e.jsx("div",{className:"absolute bottom-[-4px] right-[-4px] border border-slate-700 text-slate-300 w-3 h-3 flex items-center justify-center rounded-full font-bold z-10 text-[8px] bg-black",children:m.level}),e.jsx("div",{className:"opacity-80 scale-90",children:le(m.id,!0)})]},`p-${g}`)),p.map((m,g)=>e.jsx("div",{className:"w-8 h-8 bg-black/20 border border-slate-900 rounded flex items-center justify-center",children:e.jsx("div",{className:"w-1 h-1 rounded-full bg-slate-900 opacity-50"})},`pe-${g}`))]})]})]}),a&&e.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-32 bg-black/70 text-purple-200 px-6 py-2 rounded-full border border-purple-900/50 backdrop-blur text-center max-w-lg animate-bounce",children:e.jsxs("span",{className:"fantasy-font italic text-lg tracking-wide",children:['"',a,'"']})}),e.jsx("div",{className:"self-center w-full max-w-xl mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute z-10 left-[-1rem] top-1/2 -translate-y-1/2 bg-slate-900 border-2 border-red-900 rounded-full p-1.5 shadow-lg",children:e.jsx("div",{className:`w-3 h-3 rounded-full bg-red-500 ${o<30?"animate-ping":""}`})}),e.jsxs("div",{className:"w-full h-6 bg-slate-950 rounded-full border-2 border-slate-700 overflow-hidden relative shadow-lg",children:[e.jsx("div",{className:"h-full transition-all duration-200 ease-out relative",style:{width:`${o}%`,backgroundColor:o<30?"#ef4444":t.color},children:e.jsx("div",{className:"absolute top-0 left-0 w-full h-1/2 bg-white/20"})}),e.jsxs("span",{className:"absolute inset-0 flex items-center justify-center text-white drop-shadow-md tracking-wider font-mono font-bold text-[11px] shadow-black",children:[Math.ceil(t.hp)," / ",Math.ceil(t.maxHp)," HP"]})]})]})})]})},tt=({upgrades:t,onSelect:s})=>e.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-900 border-2 border-yellow-600/50 rounded-lg p-8 max-w-4xl w-full shadow-2xl",children:[e.jsx("h2",{className:"text-4xl text-center text-yellow-500 fantasy-font mb-2 drop-shadow-lg",children:"Level Up!"}),e.jsx("p",{className:"text-center text-slate-400 mb-8 italic",children:"Choose your destiny..."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:t.map(l=>{const a=l.rarity==="legendary";return e.jsxs("button",{onClick:()=>s(l),className:`group relative border p-6 rounded transition-all duration-200 text-left flex flex-col gap-2 ${a?"bg-purple-900/40 border-purple-500 hover:bg-purple-900/60 hover:scale-105":"bg-slate-800 border-slate-600 hover:bg-slate-700 hover:border-yellow-500 hover:-translate-y-1"}`,children:[a&&e.jsxs("div",{className:"absolute -top-3 -right-3 bg-purple-600 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg flex items-center gap-1 animate-bounce z-10",children:[e.jsx(J,{size:12})," EVOLUTION"]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:`text-xl font-bold ${a?"text-purple-100":"text-yellow-100 group-hover:text-yellow-400"}`,children:l.name}),e.jsx("span",{className:`text-xs uppercase tracking-wider font-bold ${a?"text-purple-300":l.rarity==="rare"?"text-blue-400":"text-slate-500"}`,children:l.rarity}),e.jsx("p",{className:`text-sm mt-2 leading-relaxed ${a?"text-purple-200":"text-slate-300"}`,children:l.description})]})]},l.id)})})]})}),st=({onResume:t,onQuit:s,stats:l})=>{const a=Math.floor(l.time/60),r=l.time%60,n=`${a.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return e.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border-2 border-slate-700 p-8 rounded-lg shadow-2xl max-w-md w-full relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent opacity-50"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-red-900 to-transparent opacity-50"}),e.jsx("h2",{className:"text-4xl text-white fantasy-font text-center mb-2 tracking-widest drop-shadow-md",children:"PAUSED"}),e.jsx("div",{className:"h-px w-24 bg-slate-600 mx-auto mb-6"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8 text-center text-slate-300 font-mono text-sm bg-slate-950/50 p-4 rounded border border-slate-800",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-500 text-xs uppercase",children:"Time"}),e.jsx("span",{className:"text-lg text-yellow-500",children:n})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-500 text-xs uppercase",children:"Level"}),e.jsx("span",{className:"text-lg text-blue-500",children:l.level})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-slate-500 text-xs uppercase",children:"Kills"}),e.jsx("span",{className:"text-lg text-red-500",children:l.kills})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:t,className:"group flex items-center justify-center gap-3 w-full py-4 bg-red-900/80 hover:bg-red-800 text-white rounded border border-red-700 hover:border-red-500 transition-all shadow-lg",children:[e.jsx(oe,{size:20,className:"fill-white group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"font-bold tracking-wider",children:"RESUME GAME"})]}),e.jsx("div",{className:"h-px bg-slate-800 w-full my-1"}),e.jsxs("button",{onClick:s,className:"flex items-center justify-center gap-3 w-full py-3 bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white rounded border border-slate-700 transition-all",children:[e.jsx(Ce,{size:20}),e.jsx("span",{className:"font-bold tracking-wider",children:"QUIT TO MENU"})]})]}),e.jsx("p",{className:"text-center text-slate-600 text-xs mt-6 italic",children:'"Rest while you can, survivor."'})]})})},at=({rewards:t,gold:s,onClose:l})=>{const[a,r]=u.useState("DROP"),[n,c]=u.useState([]);u.useEffect(()=>{if(a==="DROP"){const o=setTimeout(()=>r("SHAKE"),600);return()=>clearTimeout(o)}if(a==="SHAKE"){const o=setTimeout(()=>{r("OPEN"),i()},1200);return()=>clearTimeout(o)}if(a==="OPEN"){const o=setTimeout(()=>r("REVEAL"),1500);return()=>clearTimeout(o)}},[a]);const i=()=>{const o=[];for(let d=0;d<40;d++){const x=Math.random()*Math.PI*2,b=150+Math.random()*150;o.push({id:d,tx:Math.cos(x)*b,ty:Math.sin(x)*b,color:Math.random()>.3?"#fbbf24":"#ffffff"})}c(o)};return e.jsxs("div",{className:"absolute inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm",children:[e.jsx("style",{children:`
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        @keyframes beams {
            0% { opacity: 0; transform: scale(0.5) rotate(0deg); }
            20% { opacity: 1; }
            100% { opacity: 0; transform: scale(2) rotate(180deg); }
        }
        @keyframes particle {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(0); opacity: 0; }
        }
        .chest-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both infinite; }
        .beam-effect { animation: beams 1.5s ease-out forwards; }
        .particle-effect { animation: particle 1s ease-out forwards; }
      `}),e.jsxs("div",{className:"flex flex-col items-center justify-center w-full max-w-2xl p-8 relative",children:[a==="OPEN"&&e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:[e.jsx("div",{className:"absolute bg-yellow-500/30 beam-effect rounded-full blur-xl z-0 w-[800px] h-[800px]",style:{background:"conic-gradient(from 0deg, transparent, rgba(234,179,8,0.3), transparent)"}}),n.map(o=>e.jsx("div",{className:"absolute top-1/2 left-1/2 w-3 h-3 rounded-full particle-effect z-10",style:{backgroundColor:o.color,"--tx":`${o.tx}px`,"--ty":`${o.ty}px`}},o.id))]}),a!=="REVEAL"?e.jsxs("div",{className:`relative transition-all duration-300 transform 
                ${a==="DROP"?"scale-0 opacity-0":"scale-125 opacity-100"}
                ${a==="SHAKE"?"chest-shake":""}
            `,style:a==="DROP"?{transform:"translateY(-100px) scale(0)"}:{},children:[e.jsxs("div",{className:"relative w-64 h-48",children:[e.jsxs("div",{className:"absolute bottom-0 w-full rounded-b-xl border-4 border-yellow-600 shadow-2xl z-10 overflow-hidden h-[75%]",style:{background:"linear-gradient(to bottom, #92400e, #451a03)"},children:[e.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-6 bg-yellow-600 border-x border-yellow-900/50"}),e.jsx("div",{className:"absolute right-8 top-0 bottom-0 w-6 bg-yellow-600 border-x border-yellow-900/50"}),e.jsx("div",{className:"absolute top-2 left-1/2 -translate-x-1/2 w-10 h-10 bg-black/40 rounded-full blur-[2px]"})]}),e.jsxs("div",{className:"absolute top-0 w-full rounded-t-xl border-4 border-b-0 border-yellow-500 z-20 origin-bottom transition-transform duration-300 ease-out h-[40%]",style:{background:"linear-gradient(to bottom, #b45309, #78350f)",transform:a==="OPEN"?"rotate(-120deg) translateY(-48px)":"rotate(0deg)"},children:[e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full bg-gradient-to-r from-transparent via-yellow-400/10 to-transparent"}),e.jsx("div",{className:"absolute left-8 top-0 bottom-0 w-6 bg-yellow-600 border-x border-yellow-900/50"}),e.jsx("div",{className:"absolute right-8 top-0 bottom-0 w-6 bg-yellow-600 border-x border-yellow-900/50"}),e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 translate-y-1/2 w-12 h-14 rounded border-2 border-yellow-200 shadow-lg z-30 flex items-center justify-center bg-gradient-to-br from-yellow-400 to-yellow-600",children:e.jsx("div",{className:"w-4 h-6 bg-black rounded-full"})})]}),e.jsx("div",{className:`absolute top-1/2 left-4 right-4 h-2 bg-yellow-200 blur-md transition-opacity duration-300 z-15 ${a==="OPEN"?"opacity-100":"opacity-0"}`})]}),a==="OPEN"&&e.jsx("div",{className:"absolute inset-0 bg-white animate-ping opacity-50 z-50 rounded-xl"})]}):e.jsxs("div",{className:"w-full flex flex-col items-center",children:[e.jsx("h2",{className:"text-6xl text-transparent bg-clip-text fantasy-font mb-4 tracking-widest bg-gradient-to-b from-yellow-200 to-yellow-600 drop-shadow-[0_0_15px_rgba(234,179,8,0.5)]",children:"TREASURE!"}),e.jsx("div",{className:"border-y border-yellow-700/50 w-full py-4 mb-8 flex justify-center bg-gradient-to-r from-slate-900/80 via-yellow-900/30 to-slate-900/80",children:e.jsxs("div",{className:"bg-yellow-950/80 border border-yellow-600 rounded-full px-8 py-2 text-yellow-200 flex items-center gap-3 shadow-[0_0_10px_rgba(234,179,8,0.3)]",children:[e.jsx(be,{className:"text-yellow-400 fill-yellow-400/20",size:20}),e.jsxs("span",{className:"font-bold text-xl tracking-wide",children:["+",s," Gold"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 w-full mb-10",children:[t.map((o,d)=>e.jsxs("div",{className:"group bg-slate-800/80 border-2 border-yellow-600/60 p-5 rounded-xl flex items-center gap-5 shadow-2xl transition-colors hover:border-yellow-400",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-yellow-500 blur opacity-20 group-hover:opacity-40 transition-opacity"}),e.jsx("div",{className:"bg-slate-900 p-4 rounded-full border border-yellow-700 relative z-10",children:e.jsx(J,{className:"text-yellow-400",size:28})})]}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h3",{className:"text-2xl font-bold text-yellow-100 mb-1",children:o.name}),e.jsx("p",{className:"text-yellow-200/60 font-mono text-sm",children:o.description})]}),e.jsx("div",{className:"text-xs uppercase font-bold text-green-300 bg-green-900/40 px-3 py-1.5 rounded border border-green-500/30",children:"LEVEL UP"})]},d)),t.length===0&&e.jsx("div",{className:"text-center text-slate-500 italic p-4 border border-slate-800 rounded",children:"The chest contained only gold..."})]}),e.jsxs("button",{onClick:l,className:"group text-white font-bold py-4 px-16 rounded-lg transition-all hover:scale-105 flex items-center gap-3 border border-yellow-400/30 bg-gradient-to-r from-yellow-700 to-yellow-600 shadow-[0_0_30px_rgba(202,138,4,0.3)]",children:[e.jsx(Pe,{size:28,className:"group-hover:scale-110 transition-transform"}),e.jsx("span",{className:"text-xl",children:"CLAIM REWARDS"})]})]})]})]})},rt={blue:"text-blue-400 border-blue-500/50",green:"text-green-400 border-green-500/50",red:"text-red-400 border-red-500/50",yellow:"text-yellow-400 border-yellow-500/50",purple:"text-purple-400 border-purple-500/50",emerald:"text-emerald-400 border-emerald-500/50",orange:"text-orange-400 border-orange-500/50",cyan:"text-cyan-400 border-cyan-500/50"},k=({label:t,value:s,icon:l,color:a})=>{const n=rt[a].split(" ")[0];return e.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-4 rounded-lg flex items-center gap-4 hover:border-slate-600 transition-colors",children:[e.jsx("div",{className:`p-3 rounded-full bg-slate-950 border border-slate-800 ${n}`,children:l}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs uppercase font-bold tracking-wider",children:t}),e.jsx("p",{className:"text-xl font-bold text-slate-200 font-mono",children:s})]})]})},lt=({stats:t,onBack:s})=>{const l=K.length,a=K.filter(x=>x.condition(t)).length,r=Math.round(a/l*100),n=t.gamesPlayed>0?Math.floor(t.totalTime/t.gamesPlayed):0,c=Math.floor(n/60),i=n%60,o=Math.floor(t.totalTime/3600),d=Math.floor(t.totalTime%3600/60);return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center bg-slate-950 z-50 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl w-full",children:[e.jsxs("button",{onClick:s,className:"mb-8 flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(L,{size:20})," Back to Menu"]}),e.jsx("h2",{className:"text-4xl text-yellow-500 fantasy-font mb-6 border-b border-slate-800 pb-4",children:"Grim Records"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-12",children:[e.jsx(k,{label:"Games Played",value:t.gamesPlayed,icon:e.jsx(pe,{size:20}),color:"blue"}),e.jsx(k,{label:"Total Playtime",value:`${o}h ${d}m`,icon:e.jsx(Ae,{size:20}),color:"cyan"}),e.jsx(k,{label:"Avg. Survival",value:`${c}m ${i}s`,icon:e.jsx(T,{size:20}),color:"green"}),e.jsx(k,{label:"Completion",value:`${r}%`,icon:e.jsx(Le,{size:20}),color:"yellow"}),e.jsx(k,{label:"Total Kills",value:t.totalKills.toLocaleString(),icon:e.jsx(y,{size:20}),color:"red"}),e.jsx(k,{label:"Best Kill Streak",value:(t.maxKills||0).toLocaleString(),icon:e.jsx(Re,{size:20}),color:"orange"}),e.jsx(k,{label:"Gems Collected",value:(t.totalGems||0).toLocaleString(),icon:e.jsx(be,{size:20}),color:"emerald"}),e.jsx(k,{label:"Bosses Slain",value:t.bossesKilled,icon:e.jsx(y,{size:20}),color:"purple"})]}),e.jsxs("h3",{className:"text-2xl text-slate-300 fantasy-font mb-4 flex items-center gap-2",children:["Achievements ",e.jsxs("span",{className:"text-sm font-sans text-slate-500 bg-slate-900 px-2 py-1 rounded-full border border-slate-800",children:[a," / ",l]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pb-8",children:K.map(x=>{const b=x.condition(t);return e.jsxs("div",{className:`p-6 rounded-lg border ${b?"bg-slate-900 border-yellow-600/50 shadow-lg":"bg-slate-900/50 border-slate-800 opacity-60"} flex items-center gap-4 transition-all`,children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center text-3xl bg-slate-800 border ${b?"border-yellow-500 text-yellow-500":"border-slate-700 text-slate-600"}`,children:b?x.icon:e.jsx(z,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-xl font-bold ${b?"text-yellow-100":"text-slate-400"}`,children:x.title}),e.jsx("p",{className:"text-slate-400 text-sm",children:x.description})]}),b&&e.jsx(Me,{className:"text-green-500"})]},x.id)})})]})})},ot=t=>{switch(t){case"spinach":return e.jsx(y,{size:24,className:"text-red-400"});case"empty_tome":return e.jsx(T,{size:24,className:"text-yellow-400"});case"candelabrador":return e.jsx(M,{size:24,className:"text-cyan-400"});case"bracer":return e.jsx(E,{size:24,className:"text-slate-300"});case"clover":return e.jsx(X,{size:24,className:"text-green-400"});case"wings":return e.jsx(E,{size:24,className:"text-slate-200"});case"attractorb":return e.jsx(Z,{size:24,className:"text-blue-400"});case"pummarola":return e.jsx(R,{size:24,className:"text-pink-400"});case"duplicator":return e.jsx(ne,{size:24,className:"text-indigo-400"});default:return e.jsx(w,{size:24,className:"text-white"})}},nt=t=>{switch(t){case"spinach":return"#f87171";case"empty_tome":return"#facc15";case"candelabrador":return"#22d3ee";case"bracer":return"#cbd5e1";case"clover":return"#4ade80";case"wings":return"#e2e8f0";case"attractorb":return"#60a5fa";case"pummarola":return"#f472b6";case"duplicator":return"#818cf8";default:return"#94a3b8"}},it=(t,s)=>{if(!s)return e.jsx(z,{size:24,className:"text-slate-500"});switch(t){case"shadow_bolt":return e.jsx(w,{size:24,className:"text-indigo-400"});case"obsidian_shard":return e.jsx(y,{size:24,className:"text-slate-400"});case"spectral_shield":return e.jsx(ue,{size:24,className:"text-cyan-400"});case"corrosive_aura":return e.jsx(y,{size:24,className:"text-lime-400"});case"thunder_strike":return e.jsx(w,{size:24,className:"text-fuchsia-400"});case"plasma_cutter":return e.jsx(D,{size:24,className:"text-orange-400"});case"blood_siphon":return e.jsx(me,{size:24,className:"text-red-500"});case"frost_nova":return e.jsx(xe,{size:24,className:"text-cyan-300"});case"whirling_axe":return e.jsx(de,{size:24,className:"text-yellow-600"});case"flame_breath":return e.jsx(ce,{size:24,className:"text-orange-500"});case"void_trap":return e.jsx(pe,{size:24,className:"text-purple-800"});case"ricochet_blade":return e.jsx(v,{size:24,className:"text-slate-300"});case"vortex_orb":return e.jsx(D,{size:24,className:"text-violet-600"});case"inferno_grenade":return e.jsx(ie,{size:24,className:"text-red-600"});case"phantom_daggers":return e.jsx(v,{size:24,className:"text-slate-200"});default:return e.jsx(v,{size:24,className:"text-white"})}},ct=(t,s)=>{if(t==="amount")return`+${s} Amount`;if(t==="recovery")return`+${s} HP/sec`;const l=t.replace(/([A-Z])/g," $1").replace(/^./,a=>a.toUpperCase());return`+${Math.round(s*100)}% ${l}`},dt={shadow_bolt:{dmg:15,cd:"0.8s",type:"Projectile",note:"Nearest Target"},obsidian_shard:{dmg:35,cd:"1.3s",type:"Lobbed",note:"High Arc"},spectral_shield:{dmg:15,cd:"3.0s",type:"Orbital",note:"Defensive"},corrosive_aura:{dmg:5,cd:"0.5s",type:"Aura",note:"Damage Zone"},thunder_strike:{dmg:50,cd:"1.5s",type:"Instant",note:"Random Target"},plasma_cutter:{dmg:25,cd:"1.0s",type:"Wave",note:"Infinite Pierce"},blood_siphon:{dmg:10,cd:"1.2s",type:"Projectile",note:"Heals Player"},frost_nova:{dmg:10,cd:"3.0s",type:"Area",note:"Freezes Enemies"},whirling_axe:{dmg:20,cd:"2.0s",type:"Spiral",note:"Expanding Orbit"},flame_breath:{dmg:8,cd:"1.5s",type:"Cone",note:"Short Range"},void_trap:{dmg:4,cd:"3.3s",type:"Trap",note:"Lingering Zone"},ricochet_blade:{dmg:15,cd:"1.2s",type:"Projectile",note:"Bounces"},vortex_orb:{dmg:5,cd:"3.0s",type:"Projectile",note:"Pull Effect"},inferno_grenade:{dmg:40,cd:"1.6s",type:"Lobbed",note:"Explodes"},phantom_daggers:{dmg:15,cd:"0.8s",type:"Projectile",note:"Rear Fire"},umbral_barrage:{dmg:25,cd:"0.7s",type:"Barrage",note:"Massive Dmg"}},xt=({stats:t,onBack:s})=>{const[l,a]=u.useState("CHARACTERS");return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center bg-slate-950 z-50 p-8 overflow-y-auto",children:e.jsxs("div",{className:"max-w-5xl w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-slate-800 pb-4",children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors",children:[e.jsx(L,{size:20})," Back to Menu"]}),e.jsx("h2",{className:"text-4xl text-yellow-500 fantasy-font",children:"Library"}),e.jsx("div",{className:"w-24"})]}),e.jsxs("div",{className:"flex gap-4 mb-8 justify-center flex-wrap",children:[e.jsxs("button",{onClick:()=>a("CHARACTERS"),className:`px-6 py-2 rounded flex items-center gap-2 font-bold transition-all ${l==="CHARACTERS"?"bg-red-800 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:[e.jsx(I,{size:18})," Survivors"]}),e.jsxs("button",{onClick:()=>a("WEAPONS"),className:`px-6 py-2 rounded flex items-center gap-2 font-bold transition-all ${l==="WEAPONS"?"bg-red-800 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:[e.jsx(v,{size:18})," Arsenal"]}),e.jsxs("button",{onClick:()=>a("PASSIVES"),className:`px-6 py-2 rounded flex items-center gap-2 font-bold transition-all ${l==="PASSIVES"?"bg-red-800 text-white":"bg-slate-800 text-slate-400 hover:bg-slate-700"}`,children:[e.jsx(J,{size:18})," Passives"]})]}),l==="CHARACTERS"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(r=>{var i;const n=r.isUnlocked(t),c=n?r.color:"#334155";return e.jsx("div",{className:"relative group rounded-xl overflow-hidden border-2 transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl",style:{borderColor:c,backgroundColor:"#0f172a"},children:e.jsxs("div",{className:"relative p-5 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"w-16 h-16 rounded-full shadow-lg border-2 border-slate-700 flex items-center justify-center text-2xl relative overflow-hidden",style:{backgroundColor:n?r.color:"#1e293b"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-black/40 to-transparent"}),e.jsx("div",{className:"relative z-10",children:n?e.jsx(I,{className:"text-white/50"}):e.jsx(z,{className:"text-slate-500"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-2xl font-bold fantasy-font ${n?"text-white":"text-slate-500"}`,children:r.name}),e.jsx("p",{className:`text-xs font-bold uppercase tracking-wider ${n?"text-white/60":"text-slate-600"}`,children:r.title})]})]}),n?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-slate-400 text-sm italic mb-6 min-h-[40px] leading-relaxed border-l-2 border-slate-700 pl-3",children:['"',r.description,'"']}),e.jsxs("div",{className:"bg-slate-950/50 rounded-lg p-3 grid grid-cols-2 gap-y-3 gap-x-4 mb-4 border border-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",title:"Max Health",children:[e.jsx(R,{size:14,className:"text-red-500"}),e.jsxs("span",{className:"font-mono",children:[r.baseStats.maxHp," HP"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",title:"Movement Speed",children:[e.jsx(E,{size:14,className:"text-blue-400"}),e.jsxs("span",{className:"font-mono",children:[r.baseStats.speed," Speed"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",title:"Damage Multiplier",children:[e.jsx(v,{size:14,className:"text-orange-500"}),e.jsxs("span",{className:`font-mono ${r.baseStats.might!==1?"text-orange-300 font-bold":""}`,children:[Math.round(r.baseStats.might*100),"% Might"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",title:"Area Multiplier",children:[e.jsx(M,{size:14,className:"text-cyan-500"}),e.jsxs("span",{className:`font-mono ${r.baseStats.area!==1?"text-cyan-300 font-bold":""}`,children:[Math.round(r.baseStats.area*100),"% Area"]})]})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-800 flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-500 font-bold uppercase",children:"Starting Weapon"}),e.jsxs("div",{className:"flex items-center gap-2 text-yellow-500 font-bold text-sm bg-yellow-900/10 px-2 py-1 rounded border border-yellow-900/30",children:[e.jsx(v,{size:14}),((i=Q[r.startingWeaponId])==null?void 0:i.name)||"Unknown"]})]})]}):e.jsxs("div",{className:"mt-6 p-4 bg-slate-950/80 rounded border border-red-900/30 text-center flex flex-col items-center justify-center min-h-[140px]",children:[e.jsx(z,{className:"mb-3 text-slate-700",size:32}),e.jsx("p",{className:"text-red-900/80 font-bold uppercase text-xs mb-2",children:"Locked Condition"}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:r.unlockCondition})]})]})},r.id)})}),l==="WEAPONS"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(Q).map(([r,n])=>{const c=n.unlockCondition(t),i=dt[r],o=Ie[r.replace(/_([a-z])/g,x=>x[1].toUpperCase())]||"#64748b",d=c?o:"#334155";return e.jsx("div",{className:"relative group rounded-xl overflow-hidden border-2 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl",style:{borderColor:d,backgroundColor:"#0f172a"},children:e.jsxs("div",{className:"relative p-5 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"w-16 h-16 rounded-lg shadow-lg border-2 border-slate-700 flex items-center justify-center text-2xl relative overflow-hidden bg-slate-800",style:{borderColor:c?o:"#334155"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-black/40 to-transparent"}),e.jsx("div",{className:"relative z-10",children:it(r,c)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-xl font-bold fantasy-font ${c?"text-slate-200":"text-slate-600"}`,children:n.name}),c&&i&&e.jsx("p",{className:"text-xs font-bold uppercase tracking-wider text-slate-500",children:i.type})]})]}),c?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 min-h-[40px]",children:n.description}),i&&e.jsxs("div",{className:"bg-slate-950/50 rounded-lg p-3 grid grid-cols-2 gap-y-3 gap-x-4 border border-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",title:"Base Damage",children:[e.jsx(v,{size:14,className:"text-red-500"}),e.jsxs("span",{className:"font-mono text-red-200",children:[i.dmg," Dmg"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",title:"Cooldown",children:[e.jsx(T,{size:14,className:"text-yellow-500"}),e.jsxs("span",{className:"font-mono text-yellow-200",children:[i.cd," CD"]})]}),i.note&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-400 font-bold col-span-2 bg-emerald-950/30 p-1.5 rounded border border-emerald-900/50",children:[e.jsx(w,{size:14}),e.jsx("span",{children:i.note})]})]})]}):e.jsxs("div",{className:"mt-6 p-4 bg-slate-950/80 rounded border border-red-900/30 text-center flex flex-col items-center justify-center min-h-[140px]",children:[e.jsx(z,{className:"mb-3 text-slate-700",size:32}),e.jsx("p",{className:"text-red-900/80 font-bold uppercase text-xs mb-2",children:"Locked"}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:n.unlockText})]})]})},r)})}),l==="PASSIVES"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(De).map(([r,n])=>{const c=nt(r);return e.jsx("div",{className:"relative group rounded-xl overflow-hidden border-2 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl",style:{borderColor:c,backgroundColor:"#0f172a"},children:e.jsxs("div",{className:"relative p-5 z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("div",{className:"w-16 h-16 rounded-lg shadow-lg border-2 border-slate-700 flex items-center justify-center text-2xl relative overflow-hidden bg-slate-800",style:{borderColor:c},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-black/40 to-transparent"}),e.jsx("div",{className:"relative z-10",children:ot(r)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold fantasy-font text-slate-200",children:n.name}),e.jsxs("div",{className:"text-xs text-slate-500 font-mono bg-slate-950/50 px-2 py-0.5 rounded border border-slate-800 inline-block mt-1",children:["Max Level: ",n.maxLevel]})]})]}),e.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 min-h-[40px]",children:n.description}),e.jsxs("div",{className:"bg-slate-950/50 rounded-lg p-3 border border-slate-800/50",children:[e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase mb-1 tracking-wider",children:"Per Level Bonus"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{size:14,className:"text-emerald-500 rotate-90"}),e.jsx("p",{className:"text-sm font-mono text-emerald-400 font-bold",children:ct(n.stat,n.increase)})]})]})]})},r)})})]})})},mt=t=>{switch(t){case"might":return"#ef4444";case"maxHp":return"#b91c1c";case"recovery":return"#f472b6";case"cooldownReduction":return"#facc15";case"area":return"#06b6d4";case"speed":return"#3b82f6";case"growth":return"#10b981";case"greed":return"#fbbf24";case"luck":return"#4ade80";case"magnet":return"#818cf8";default:return"#94a3b8"}},ut=(t,s=24)=>{switch(t){case"might":return e.jsx(v,{size:s});case"maxHp":return e.jsx(R,{size:s});case"recovery":return e.jsx($e,{size:s});case"cooldownReduction":return e.jsx(T,{size:s});case"area":return e.jsx(M,{size:s});case"speed":return e.jsx(E,{size:s});case"growth":return e.jsx(Oe,{size:s});case"greed":return e.jsx(Y,{size:s});case"luck":return e.jsx(X,{size:s});case"magnet":return e.jsx(Z,{size:s});default:return e.jsx(w,{size:s})}},bt=({stats:t,onBack:s,onUpdateStats:l})=>{const[a,r]=u.useState(t.gold||0),[n,c]=u.useState(t.powerUps||{}),i=o=>{const d=n[o.id]||0;if(d>=o.maxLevel)return;const x=Math.floor(o.baseCost*Math.pow(o.costMultiplier,d));if(a>=x){const b=a-x,f={...n,[o.id]:d+1};r(b),c(f);const p={...t,gold:b,powerUps:f};Be(p),l(p)}};return e.jsx("div",{className:"absolute inset-0 flex flex-col items-center bg-slate-950 z-50 p-6 overflow-y-auto",children:e.jsxs("div",{className:"max-w-6xl w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-slate-800 pb-4 sticky top-0 bg-slate-950/95 backdrop-blur z-20 py-4 px-2",children:[e.jsxs("button",{onClick:s,className:"flex items-center gap-2 text-slate-400 hover:text-white transition-colors group",children:[e.jsx(L,{size:20,className:"group-hover:-translate-x-1 transition-transform"})," Back"]}),e.jsx("h2",{className:"text-4xl text-yellow-500 fantasy-font drop-shadow-md",children:"Power Up Store"}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-900 px-5 py-2 rounded-full border border-yellow-700/50",children:[e.jsx(Y,{className:"text-yellow-400 fill-yellow-400/20",size:20}),e.jsx("span",{className:"text-yellow-100 font-mono font-bold text-xl tracking-wide",children:a.toLocaleString()})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-12",children:He.map(o=>{const d=n[o.id]||0,x=d>=o.maxLevel,b=Math.floor(o.baseCost*Math.pow(o.costMultiplier,d)),f=a>=b,p=mt(o.statKey);return e.jsx("div",{className:"relative group rounded-xl overflow-hidden border-2 transition-all duration-300 hover:-translate-y-1 bg-[#0f172a] flex flex-col",style:{borderColor:x?"#334155":p},children:e.jsxs("div",{className:"relative p-5 flex flex-col h-full z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"w-14 h-14 rounded-lg shadow-lg border-2 border-slate-700 flex items-center justify-center text-2xl relative overflow-hidden bg-slate-800",style:{borderColor:p,color:p},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-black/40 to-transparent"}),e.jsx("div",{className:"relative z-10",children:ut(o.statKey,28)})]}),e.jsxs("div",{className:`text-xs font-bold px-2.5 py-1 rounded border ${x?"bg-green-900/30 border-green-700/50 text-green-400":"bg-slate-900 border-slate-700 text-slate-400"}`,children:["LVL ",d," / ",o.maxLevel]})]}),e.jsxs("div",{className:"mb-4 flex-grow",children:[e.jsx("h3",{className:`text-xl font-bold fantasy-font mb-2 ${x?"text-slate-400":"text-slate-200"}`,children:o.name}),e.jsx("p",{className:"text-sm text-slate-400 leading-relaxed min-h-[40px]",children:o.description})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-800 rounded-full overflow-hidden mb-6 border border-slate-700/50",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${d/o.maxLevel*100}%`,backgroundColor:p}})}),e.jsx("button",{onClick:()=>i(o),disabled:x||!f,className:`w-full py-3.5 rounded-lg font-bold flex items-center justify-center gap-2 transition-all relative overflow-hidden group/btn ${x?"bg-slate-800 text-slate-500 cursor-default border border-slate-700":f?"text-white shadow-lg hover:scale-[1.02] active:scale-95":"bg-slate-900 text-red-400/60 cursor-not-allowed border border-red-900/20 grayscale"}`,style:!x&&f?{background:"linear-gradient(to bottom, #ca8a04, #854d0e)",borderTop:"1px solid #fde047",borderBottom:"1px solid #713f12"}:{},children:x?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:16})," MAXED OUT"]}):e.jsxs(e.Fragment,{children:[f?e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover/btn:translate-y-0 transition-transform duration-300 pointer-events-none"}):null,e.jsx(Te,{size:18,className:f?"animate-bounce":""}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:b.toLocaleString()}),e.jsx(Y,{size:14,className:f?"text-yellow-200":"text-red-400/60"})]})]})})]})},o.id)})})]})})},pt=async t=>ht(t.situation),ht=(t,s)=>{const l=a=>a[Math.floor(Math.random()*a.length)];switch(t){case"LEVEL_UP":return l(["Power surges through your veins.","The abyss gazes back, and you blink not.","Your soul grows darker, yet stronger.","Ascension is inevitable.","More power. More blood.","You are becoming something else.","The shadows bow to you.","Limitless potential unleashed.","A new plateau of strength.","The ancient seals weaken."]);case"GAME_OVER":return l(["The darkness consumes you.","Your light has faded.","Rest now, warrior.","The horde was too many.","A valiant effort, extinguished.","Return to the void.","Your journey ends here.","Dust to dust.","The night claims another.","You fought well, but the shadows won."]);case"BOSS_SPAWN":return l(["A terrible presence approaches.","The ground trembles beneath you.","Something ancient has awoken.","Prepare yourself. It is here.","A titan of the void emerges.","Death comes for you.","Face your doom!","The air grows heavy with malice.","An entity of pure dread manifests.","The master of this realm descends."]);default:return"Survive."}},ft=()=>e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-slate-950 z-50",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"loader"}),e.jsx("p",{className:"text-red-500 font-mono text-sm animate-pulse",children:"SUMMONING..."})]})}),gt=()=>{const t=u.useRef(null),s=u.useRef(null),[l,a]=u.useState(0),[r,n]=u.useState(null),[c,i]=u.useState(0),[o,d]=u.useState(0),[x,b]=u.useState([]),[f,p]=u.useState({rewards:[],gold:0}),[m,g]=u.useState(""),[O,B]=u.useState(se()),[ee,te]=u.useState(!1);u.useEffect(()=>{B(se())},[l===0]),u.useEffect(()=>{const h=j=>{j.code==="Escape"&&(l===4?W(!0):l===5&&W(!1))};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[l]);const W=h=>{s.current&&(h?(s.current.isPaused=!0,a(5)):(s.current.isPaused=!1,a(4)))},je=async h=>{if(t.current){s.current&&(s.current.destroy(),s.current=null),n(null),i(0),d(0),te(!0);try{const{GameEngine:j}=await Xe(async()=>{const{GameEngine:_}=await import("./engine-DEAhEcxm.js").then(C=>C.E);return{GameEngine:_}},[],import.meta.url),N=new j(t.current,h,_=>{b(_),a(6),F("LEVEL_UP",N)},_=>{a(7),F("GAME_OVER",N);const C=We(_);B(C)},()=>{F("BOSS_SPAWN",N)},()=>{ve(N)});s.current=N,N.start(),a(4),g("")}catch(j){console.error("Failed to load game engine:",j),alert("Failed to load game resources. Please refresh.")}finally{te(!1)}}},ve=h=>{const N=Math.random()<.2?3:1,_=Math.floor(Math.random()*200+100)*h.player.stats.greed,C=[],G=h.player.weapons.filter(P=>P.level<P.maxLevel);for(let P=0;P<N;P++)if(G.length>0){const ye=Math.floor(Math.random()*G.length),$=G[ye];C.push({id:`chest_upgrade_${$.id}_${Date.now()}_${P}`,name:Q[$.id].name,description:`Upgraded to Level ${$.level+1}`,rarity:"rare",type:"WEAPON",apply:Se=>{const S=Se.weapons.find(ke=>ke.id===$.id);S.level<S.maxLevel&&(S.level++,S.level%2===0&&(S.damage*=1.2),S.level%3===0&&(S.amount+=1),S.area*=1.1)}})}p({rewards:C,gold:Math.floor(_)}),a(8)},Ne=()=>{s.current&&(f.rewards.forEach(h=>h.apply(s.current.player)),s.current.goldCollected+=f.gold,s.current.isPaused=!1,a(4))},F=async(h,j)=>{const N=await pt({level:j.player.level,kills:j.score,healthPercent:j.player.hp/j.player.maxHp*100,situation:h});g(N),setTimeout(()=>g(""),4e3)};u.useEffect(()=>{let h;return(l===4||l===5||l===6||l===8)&&s.current&&(h=window.setInterval(()=>{const j=s.current;n({...j.player}),i(j.score),d(Math.floor(j.frameCount/60))},100)),()=>clearInterval(h)},[l]);const we=h=>{s.current&&(h.apply(s.current.player),s.current.isPaused=!1,a(4))},A=()=>{s.current&&(s.current.destroy(),s.current=null),a(0),n(null),i(0),d(0)};return e.jsxs("div",{className:"relative w-full h-screen bg-slate-900 overflow-hidden",children:[e.jsx("canvas",{ref:t,className:"block w-full h-full"}),ee&&e.jsx(ft,{}),l===0&&!ee&&e.jsx(Je,{onStart:je,onAchievements:()=>a(1),onLibrary:()=>a(2),onPowerUp:()=>a(3),stats:O}),l===1&&e.jsx(lt,{stats:O,onBack:A}),l===2&&e.jsx(xt,{stats:O,onBack:A}),l===3&&e.jsx(bt,{stats:O,onBack:A,onUpdateStats:h=>B(h)}),(l===4||l===5)&&e.jsx(et,{player:r,score:c,time:o,flavorText:m}),l===5&&r&&e.jsx(st,{onResume:()=>W(!1),onQuit:A,stats:{kills:c,time:o,level:r.level}}),l===6&&e.jsx(tt,{upgrades:x,onSelect:we}),l===8&&e.jsx(at,{rewards:f.rewards,gold:f.gold,onClose:Ne}),l===7&&e.jsxs("div",{className:"game-over-screen",children:[e.jsx("h2",{className:"text-6xl text-white fantasy-font mb-4 drop-shadow-lg text-center",children:"YOU DIED"}),e.jsxs("div",{className:"text-center mb-8 bg-black/40 p-6 rounded-lg border border-red-500/30",children:[e.jsxs("p",{className:"text-2xl text-red-200 mb-2 font-bold",children:["Survived: ",Math.floor(o/60),"m ",o%60,"s"]}),e.jsxs("p",{className:"text-2xl text-red-200 font-bold",children:["Kills: ",c]}),e.jsxs("p",{className:"text-xl text-slate-400 mt-4",children:["Level Reached: ",(r==null?void 0:r.level)||0]}),m&&e.jsxs("p",{className:"text-lg italic text-red-300 mt-4 border-t border-red-500/20 pt-4",children:['"',m,'"']})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx("button",{onClick:A,className:"btn-primary",children:"BACK TO MENU"})})]})]})},ge=document.getElementById("root");if(!ge)throw new Error("Could not find root element to mount to");const jt=q.createRoot(ge);jt.render(e.jsx(Ue.StrictMode,{children:e.jsx(gt,{})}));
